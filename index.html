<!doctype html>
<html lang="uk">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, user-scalable=yes, viewport-fit=cover" />
    <title>Турбівська філія Корнинського ліцею | Розклад 5-9 класів</title>
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Manrope:wght@400;500;600;700;800&family=Rubik:wght@500;600;700;800&display=swap"
      rel="stylesheet"
    />
    <style>
      :root {
        color-scheme: light;
        --bg: #f3f8f8;
        --bg-soft: #f8fcff;
        --card: #ffffff;
        --ink: #13232d;
        --muted: #4a6472;
        --line: rgba(19, 35, 45, 0.12);
        --brand: #0f8f8c;
        --brand-strong: #0d6f74;
        --brand-deep: #0a4a66;
        --warm: #ffd180;
        --cool: #d9f5ff;
        --glow: 0 22px 50px rgba(13, 111, 116, 0.18);
        --radius-xl: 28px;
        --radius-lg: 20px;
        --radius-md: 14px;
        --class-5: #fff8df;
        --class-6: #eaf8ff;
        --class-7: #f3eeff;
        --class-8: #e9fff0;
        --class-9: #fff0f5;
        --row-separator: rgba(19, 35, 45, 0.42);
        --fs-base: clamp(14px, 0.22vw + 13px, 18px);
        --fs-table: clamp(13px, 0.18vw + 12px, 16px);
        --fs-chip: clamp(17px, 0.46vw + 14px, 23px);
      }

      * {
        box-sizing: border-box;
        margin: 0;
        padding: 0;
      }

      html {
        height: 100%;
        scroll-behavior: smooth;
        overflow-x: auto;
        overflow-y: auto;
        -webkit-text-size-adjust: 100%;
        text-size-adjust: 100%;
      }

      body {
        height: 100%;
        min-height: 100vh;
        font-family: "Manrope", sans-serif;
        font-size: var(--fs-base);
        color: var(--ink);
        background: linear-gradient(160deg, var(--bg) 0%, var(--bg-soft) 62%, #eef8f4 100%);
        overflow-x: auto;
        overflow-y: auto;
        touch-action: pan-x pan-y pinch-zoom;
        text-rendering: optimizeLegibility;
        -webkit-font-smoothing: antialiased;
      }

      .app {
        position: relative;
        z-index: 1;
        width: min(1500px, calc(100% - 24px));
        margin: 28px auto 64px;
        overflow: visible;
      }

      .site-bg {
        position: fixed;
        inset: 0;
        z-index: 0;
        background: url("./Заставка.png") center / cover no-repeat;
        pointer-events: none;
      }

      .hero {
        border-radius: var(--radius-xl);
        background:
          linear-gradient(120deg, rgba(15, 143, 140, 0.15) 0%, rgba(217, 245, 255, 0.75) 55%, rgba(255, 209, 128, 0.36) 100%),
          var(--card);
        box-shadow: var(--glow);
        padding: 12px 16px;
        position: relative;
        overflow: hidden;
        text-align: center;
      }

      .hero__row {
        display: grid;
        grid-template-columns: minmax(0, 1fr) auto minmax(0, 1fr);
        align-items: center;
        column-gap: 8px;
      }

      .hero__top-tools {
        display: flex;
        justify-content: flex-start;
        width: min(380px, 100%);
        margin: 0;
      }

      .kyiv-clock {
        width: 100%;
        padding: 9px 12px;
        border-radius: 14px;
        border: 1px solid rgba(15, 143, 140, 0.28);
        background: rgba(255, 255, 255, 0.84);
        box-shadow: 0 10px 18px rgba(13, 79, 104, 0.14);
        text-align: left;
      }

      .kyiv-clock__title {
        display: block;
        margin: 0;
        font-weight: 800;
        font-size: 12px;
        color: #0f5a67;
      }

      .kyiv-clock__date {
        margin: 3px 0 1px;
        font-weight: 700;
        font-size: clamp(11px, 0.18vw + 10px, 13px);
        line-height: 1.1;
        color: #234d62;
        text-transform: capitalize;
      }

      .kyiv-clock__time {
        margin: 0;
        font-family: "Rubik", sans-serif;
        font-weight: 800;
        font-size: clamp(19px, 0.7vw + 13px, 27px);
        line-height: 1;
        color: #0c3f5c;
      }

      .kyiv-clock__sync {
        display: block;
        margin: 2px 0 0;
        font-size: 10px;
        font-weight: 700;
        color: #3f6576;
      }

      .hero::after {
        content: "";
        position: absolute;
        inset: auto -52px -70px auto;
        width: 230px;
        height: 230px;
        border-radius: 50%;
        background: radial-gradient(circle, rgba(15, 143, 140, 0.25), transparent 70%);
        pointer-events: none;
      }

      .hero__school {
        display: inline-flex;
        align-items: center;
        justify-content: center;
        margin: 0 auto 4px;
        padding: 4px 10px;
        border-radius: 999px;
        border: 1px solid rgba(15, 143, 140, 0.24);
        background: rgba(255, 255, 255, 0.72);
        color: #0f5064;
        font-weight: 800;
        font-size: 24px;
        line-height: 1.05;
      }

      .hero__title-icon {
        justify-self: end;
        font-size: clamp(52px, 3.4vw, 70px);
        line-height: 1;
        filter: drop-shadow(0 8px 12px rgba(13, 79, 104, 0.22));
      }

      .hero h1 {
        font-family: "Rubik", sans-serif;
        font-weight: 800;
        margin: 0;
        font-size: clamp(22px, 1.7vw, 33px);
        line-height: 1.06;
        letter-spacing: 0;
        text-wrap: balance;
        text-align: center;
        justify-self: center;
      }

      .hero__title-text {
        display: block;
      }

      .controls {
        margin-top: 22px;
        background: var(--card);
        border-radius: var(--radius-lg);
        border: 1px solid var(--line);
        box-shadow: 0 14px 28px rgba(19, 35, 45, 0.08);
        padding: 18px;
        display: grid;
        gap: 14px;
      }

      .controls h2 {
        font-family: "Rubik", sans-serif;
        font-size: 18px;
      }

      .controls__grid {
        display: grid;
        gap: 12px;
        grid-template-columns: repeat(2, minmax(220px, 1fr));
      }

      label {
        display: grid;
        gap: 6px;
        font-weight: 700;
        color: var(--muted);
      }

      select {
        width: 100%;
        min-height: 46px;
        padding: 9px 12px;
        border-radius: 12px;
        border: 1px solid rgba(19, 35, 45, 0.2);
        background: #fff;
        font: inherit;
        color: var(--ink);
      }

      select:focus {
        border-color: var(--brand);
        outline: 2px solid rgba(15, 143, 140, 0.2);
        outline-offset: 1px;
      }

      .class-week-nav {
        margin-top: 14px;
        background: linear-gradient(140deg, rgba(13, 79, 104, 0.1) 0%, rgba(217, 245, 255, 0.7) 60%, rgba(255, 209, 128, 0.35) 100%),
          var(--card);
        border: 1px solid rgba(13, 79, 104, 0.16);
        border-radius: var(--radius-lg);
        box-shadow: 0 14px 28px rgba(19, 35, 45, 0.08);
        padding: 16px 18px;
        position: relative;
        overflow: hidden;
      }

      .class-week-nav::before {
        content: "";
        position: absolute;
        top: -42px;
        right: -30px;
        width: 170px;
        height: 170px;
        border-radius: 50%;
        background: radial-gradient(circle, rgba(255, 255, 255, 0.55) 0%, rgba(255, 255, 255, 0) 70%);
        pointer-events: none;
      }

      .class-week-nav__head {
        display: grid;
        grid-template-columns: minmax(0, 1fr) auto minmax(0, 1fr);
        gap: 12px;
        align-items: center;
        margin-bottom: 12px;
      }

      .class-week-nav__title {
        font-family: "Rubik", sans-serif;
        font-size: clamp(18px, 0.45vw + 16px, 24px);
        font-weight: 800;
        color: #0e3a50;
        margin: 0;
        text-align: center;
        grid-column: 2;
        text-wrap: balance;
        letter-spacing: 0.01em;
      }

      .bell-link-wrap {
        display: inline-flex;
        align-items: center;
        gap: 10px;
        grid-column: 3;
        justify-self: end;
        padding: 5px 7px;
        border-radius: 999px;
        background: rgba(255, 255, 255, 0.58);
        border: 1px solid rgba(12, 79, 104, 0.14);
        backdrop-filter: blur(2px);
      }

      .bell-link {
        display: inline-flex;
        align-items: center;
        text-decoration: none;
        color: #f7fcff;
        font-weight: 800;
        font-size: clamp(14px, 0.22vw + 13px, 17px);
        border-radius: 999px;
        padding: 10px 16px;
        border: 1px solid rgba(12, 79, 104, 0.28);
        background:
          radial-gradient(circle at 18% 16%, rgba(255, 255, 255, 0.35), transparent 45%),
          linear-gradient(120deg, #0f8f8c 0%, #0a4a66 100%);
        box-shadow: 0 10px 18px rgba(12, 79, 104, 0.24);
        transition: transform 0.2s ease, box-shadow 0.2s ease, filter 0.2s ease;
      }

      .bell-link:hover,
      .bell-link:focus-visible {
        transform: translateY(-2px);
        filter: saturate(1.15);
        box-shadow: 0 16px 26px rgba(12, 79, 104, 0.34);
      }

      .bell-link__icon {
        display: inline-flex;
        align-items: center;
        justify-content: center;
        width: 38px;
        height: 38px;
        border-radius: 50%;
        border: 1px solid rgba(12, 79, 104, 0.2);
        background: linear-gradient(145deg, #ffffff 0%, #e8f4ff 100%);
        font-size: 23px;
        line-height: 1;
        transform-origin: top center;
        animation: bell-swing 2.1s ease-in-out infinite;
        filter: drop-shadow(0 3px 6px rgba(11, 38, 55, 0.42));
      }

      .bell-link__label {
        white-space: nowrap;
        letter-spacing: 0.01em;
      }

      @keyframes bell-swing {
        0%,
        100% {
          transform: rotate(0deg);
        }
        14% {
          transform: rotate(16deg);
        }
        28% {
          transform: rotate(-12deg);
        }
        42% {
          transform: rotate(8deg);
        }
        56% {
          transform: rotate(-5deg);
        }
        70% {
          transform: rotate(3deg);
        }
      }

      @keyframes soft-rise {
        from {
          opacity: 0;
          transform: translateY(14px);
        }
        to {
          opacity: 1;
          transform: translateY(0);
        }
      }

      @media (prefers-reduced-motion: no-preference) {
        .class-week-nav {
          animation: soft-rise 0.55s ease-out both;
        }

        .class-week-nav__title {
          animation: soft-rise 0.5s ease-out 0.06s both;
        }

        .bell-link-wrap {
          animation: soft-rise 0.5s ease-out 0.1s both;
        }

        .class-week-nav__buttons a {
          opacity: 0;
          transform: translateY(8px);
          animation: soft-rise 0.45s ease-out both;
          animation-delay: var(--reveal-delay, 0.14s);
        }
      }

      @media (prefers-reduced-motion: reduce) {
        .bell-link__icon {
          animation: none;
        }
      }

      .class-week-nav__buttons {
        display: flex;
        flex-wrap: wrap;
        justify-content: center;
        gap: 10px;
      }

      .class-week-nav__buttons a {
        text-decoration: none;
        color: #effbff;
        font-weight: 800;
        font-size: clamp(15px, 0.25vw + 14px, 18px);
        border-radius: 999px;
        padding: 10px 16px;
        border: 1px solid rgba(12, 79, 104, 0.25);
        background: linear-gradient(120deg, var(--brand) 0%, var(--brand-deep) 100%);
        box-shadow: 0 10px 20px rgba(12, 79, 104, 0.18);
        transition: transform 0.2s ease, box-shadow 0.2s ease, filter 0.2s ease;
      }

      .class-week-nav__buttons a:active {
        transform: translateY(0);
      }

      .class-week-nav__buttons a:hover,
      .class-week-nav__buttons a:focus-visible {
        transform: translateY(-2px);
        filter: saturate(1.12);
        box-shadow: 0 16px 24px rgba(12, 79, 104, 0.24);
      }

      .day-nav {
        margin-top: 12px;
        display: flex;
        flex-wrap: wrap;
        justify-content: center;
        gap: 12px;
      }

      .day-nav a {
        text-decoration: none;
        color: #114b61;
        font-weight: 800;
        border-radius: 999px;
        font-size: clamp(15px, 0.2vw + 14px, 18px);
        padding: 10px 16px;
        border: 1px solid rgba(15, 143, 140, 0.32);
        background: rgba(255, 255, 255, 0.92);
        box-shadow: 0 9px 20px rgba(13, 79, 104, 0.12);
        transition: transform 0.2s ease, box-shadow 0.2s ease;
      }

      .day-nav a:hover,
      .day-nav a:focus-visible {
        transform: translateY(-2px);
        box-shadow: 0 14px 22px rgba(13, 79, 104, 0.2);
      }

      .schedule {
        margin-top: 8px;
        display: grid;
        gap: 20px;
      }

      .day-card {
        background: var(--card);
        border: 1px solid var(--line);
        border-radius: var(--radius-lg);
        box-shadow: 0 22px 44px rgba(19, 35, 45, 0.12);
        overflow: hidden;
      }

      .day-header {
        display: grid;
        grid-template-columns: minmax(250px, 340px) minmax(220px, 1fr) auto;
        grid-template-areas: "filter title actions";
        align-items: center;
        gap: 10px;
        border-bottom: 1px solid var(--line);
        padding: 10px 14px;
        background: linear-gradient(160deg, #f4fffd 0%, #edf8ff 100%);
      }

      .day-subject-wrap {
        grid-area: filter;
      }

      .day-title {
        grid-area: title;
        font-family: "Rubik", sans-serif;
        font-weight: 800;
        font-size: clamp(24px, 1.04vw + 13px, 34px);
        line-height: 1.08;
        letter-spacing: 0.01em;
        text-align: center;
        color: #0d3b53;
        text-shadow: 0 8px 18px rgba(13, 79, 104, 0.15);
      }

      .day-actions {
        grid-area: actions;
        display: flex;
        gap: 8px;
        flex-wrap: wrap;
        align-items: center;
        justify-content: flex-end;
      }

      .btn {
        border: 0;
        border-radius: 10px;
        padding: 9px 13px;
        font-weight: 700;
        font: inherit;
        cursor: pointer;
        text-decoration: none;
        transition: transform 0.2s ease, box-shadow 0.2s ease;
      }

      .btn:hover,
      .btn:focus-visible {
        transform: translateY(-1px);
        box-shadow: 0 10px 20px rgba(13, 79, 104, 0.18);
      }

      .btn-top {
        color: #145b77;
        background: #e7f5ff;
      }

      .btn-print {
        color: #fff;
        background: linear-gradient(120deg, var(--brand) 0%, var(--brand-strong) 100%);
      }

      .table-wrap {
        overflow-x: auto;
        overflow-y: auto;
        max-height: min(74vh, 920px);
        max-width: 100%;
        scrollbar-gutter: stable both-edges;
        overscroll-behavior: auto;
        -webkit-overflow-scrolling: touch;
        touch-action: pan-x pan-y pinch-zoom;
      }

      table {
        width: 100%;
        border-collapse: collapse;
        min-width: 860px;
        table-layout: fixed;
      }

      th,
      td {
        border-bottom: 2px solid rgba(19, 35, 45, 0.23);
        border-right: 1px solid rgba(19, 35, 45, 0.13);
        padding: 12px 9px;
        font-size: var(--fs-table);
        text-align: center;
        vertical-align: middle;
      }

      tbody tr > th,
      tbody tr > td {
        border-bottom: 3px solid var(--row-separator);
      }

      th:first-child,
      td:first-child {
        width: 72px;
        min-width: 72px;
        max-width: 72px;
      }

      th[data-class],
      td[data-class] {
        width: auto;
      }

      .day-card.is-single-class .table-wrap {
        display: flex;
        justify-content: center;
      }

      .day-card.is-single-class table {
        width: min(620px, 100%);
        min-width: 320px;
        margin-inline: auto;
        table-layout: fixed;
      }

      .day-card.is-single-class th:first-child,
      .day-card.is-single-class td:first-child,
      .day-card.is-single-class .lesson {
        width: 52px;
        min-width: 52px;
        max-width: 52px;
        padding-left: 6px;
        padding-right: 6px;
      }

      .day-card.is-single-class th[data-class]:not(.is-hidden),
      .day-card.is-single-class td[data-class]:not(.is-hidden) {
        width: calc(100% - 52px);
      }

      .day-card.is-single-class td[data-class]:not(.is-hidden) .subject-stack {
        width: 100%;
        justify-content: center;
      }

      th:last-child,
      td:last-child {
        border-right: 0;
      }

      thead th {
        background: #f4fcfa;
        font-size: clamp(13px, 0.17vw + 12px, 17px);
        font-weight: 700;
        position: sticky;
        top: 0;
        z-index: 1;
      }

      .class-link {
        display: inline-block;
        color: #f3fbff;
        text-decoration: none;
        border-bottom: 1px dashed rgba(243, 251, 255, 0.75);
        padding-bottom: 1px;
        font-size: clamp(15px, 0.35vw + 13px, 20px);
        font-weight: 800;
      }

      .class-link:hover,
      .class-link:focus-visible {
        color: #ffffff;
        border-bottom-color: #ffffff;
      }

      thead th[data-class] {
        background: linear-gradient(140deg, #133b53 0%, #0c4f68 55%, #0b6a75 100%);
        color: #f3fbff;
        font-size: clamp(15px, 0.36vw + 13px, 20px);
        font-weight: 800;
      }

      tbody td[data-class] {
        background: var(--class-tint, #eef6ff);
      }

      .lesson {
        font-size: clamp(20px, 0.6vw + 16px, 30px);
        font-weight: 900;
        min-width: 72px;
        background: #edf4f9;
        border-right: 2px solid rgba(19, 35, 45, 0.36);
        letter-spacing: 0.01em;
      }

      .subject-stack {
        display: inline-flex;
        align-items: center;
        justify-content: center;
        gap: 6px;
        flex-wrap: wrap;
      }

      .subject-chip {
        border: 1px solid rgba(15, 143, 140, 0.24);
        background: #f7ffff;
        border-radius: 999px;
        padding: 4px 8px;
        display: inline-flex;
        align-items: center;
        gap: 6px;
        font: inherit;
        font-size: var(--fs-chip);
        font-weight: 600;
        line-height: 1.3;
        cursor: pointer;
        white-space: normal;
        overflow-wrap: anywhere;
        word-break: break-word;
        text-align: center;
        max-width: 100%;
      }

      .subject-chip--wrap {
        white-space: normal;
        max-width: 230px;
        text-align: center;
        line-height: 1.15;
        overflow-wrap: anywhere;
        word-break: break-word;
      }

      .subject-icon {
        font-size: 20px;
        line-height: 1;
      }

      .divider {
        color: var(--muted);
        font-weight: 700;
      }

      .subject-chip:hover {
        border-color: var(--brand);
        background: #ebfffe;
      }

      .subject-chip.is-linked {
        border-color: rgba(255, 255, 255, 0.45);
        background: #0c4f68;
        color: #f3fbff;
        box-shadow: inset 0 0 0 1px rgba(255, 255, 255, 0.26);
      }

      .subject-chip.is-filter-linked {
        border-color: #ffe4a3;
        background: #0c4f68;
        color: #f3fbff;
        box-shadow: inset 0 0 0 1px rgba(255, 228, 163, 0.7);
      }

      td.linked-cell {
        background: #0f6077 !important;
        color: #f3fbff;
      }

      td.linked-cell.filter-match {
        background: #0f6077 !important;
      }

      td.linked-cell .subject-chip {
        border-color: rgba(255, 255, 255, 0.4);
        background: #0c4f68;
        color: #f3fbff;
      }

      td.linked-cell .divider {
        color: #d4ecf6;
      }

      td.filter-match {
        background: #0f6077 !important;
        color: #f3fbff;
      }

      td.filter-match .subject-chip {
        border-color: rgba(255, 255, 255, 0.35);
        background: #0c4f68;
        color: #f3fbff;
      }

      td.filter-match .divider {
        color: #d4ecf6;
      }

      td.filter-dim {
        opacity: 0.35;
      }

      .empty {
        color: #8b97a1;
      }

      .is-hidden {
        display: none;
      }

      .footer {
        margin-top: 16px;
        text-align: center;
        color: var(--muted);
        font-weight: 600;
      }

      #printStage {
        display: none;
      }

      #printStage .print-bg-image {
        display: none;
      }

      @media (max-width: 1040px) {
        .day-header {
          grid-template-columns: minmax(210px, 1fr) minmax(170px, auto);
          grid-template-areas:
            "filter actions"
            "title title";
          align-items: center;
        }

        .day-subject-wrap {
          justify-self: stretch;
          width: 100%;
        }

        .day-title {
          justify-self: center;
          width: min(420px, 100%);
        }

        .day-actions {
          justify-content: flex-end;
        }
      }

      @media (max-width: 760px) {
        .app {
          width: min(1500px, calc(100% - 10px));
          margin-top: 14px;
        }

        table {
          min-width: 720px;
        }

        .hero {
          padding: 8px 8px;
        }

        .hero h1 {
          font-size: clamp(15px, 4.4vw, 21px);
          line-height: 1.03;
        }

        .hero__row {
          grid-template-columns: minmax(0, 1fr) minmax(0, 1.35fr) auto;
          column-gap: 5px;
        }

        .hero__top-tools {
          width: min(230px, 100%);
        }

        .kyiv-clock {
          padding: 6px 8px;
        }

        .hero__title-icon {
          font-size: clamp(30px, 8.2vw, 42px);
        }

        .hero__school {
          margin-bottom: 3px;
          padding: 2px 8px;
          font-size: clamp(14px, 4.4vw, 22px);
          line-height: 1;
        }

        .controls {
          padding: 12px;
        }

        .controls__grid {
          grid-template-columns: 1fr;
        }

        select {
          min-height: 42px;
          padding: 8px 10px;
        }

        .class-week-nav {
          padding: 12px;
        }

        .class-week-nav__title {
          font-size: clamp(16px, 4.8vw, 20px);
        }

        .class-week-nav__head {
          grid-template-columns: 1fr;
          gap: 10px;
          margin-bottom: 10px;
        }

        .class-week-nav__title {
          grid-column: 1;
          text-align: center;
          letter-spacing: 0.012em;
        }

        .bell-link {
          justify-content: center;
          min-height: 42px;
          padding: 8px 12px;
        }

        .bell-link-wrap {
          grid-column: 1;
          justify-content: center;
          width: min(330px, 100%);
          margin-inline: auto;
          padding: 5px;
        }

        .bell-link__icon {
          width: 34px;
          height: 34px;
          font-size: 20px;
        }

        .class-week-nav__buttons {
          display: grid;
          grid-template-columns: repeat(2, minmax(0, 1fr));
          gap: 8px;
        }

        .class-week-nav__buttons a {
          display: flex;
          justify-content: center;
          align-items: center;
          min-height: 42px;
          padding: 8px 10px;
          font-size: 14px;
          letter-spacing: 0.01em;
        }

        .day-nav {
          margin-top: 8px;
          gap: 8px;
        }

        .day-nav a {
          min-height: 40px;
          padding: 8px 10px;
          font-size: clamp(13px, 3.5vw, 15px);
        }

        .schedule {
          margin-top: 6px;
          gap: 14px;
        }

        .day-header {
          grid-template-columns: 1fr;
          grid-template-areas:
            "filter"
            "title"
            "actions";
          align-items: stretch;
          gap: 8px;
          padding: 8px 10px;
        }

        .day-subject-wrap,
        .day-title,
        .day-actions {
          width: 100%;
          justify-self: stretch;
        }

        .day-title {
          font-size: clamp(20px, 5.6vw, 28px);
          line-height: 1.06;
        }

        .day-actions {
          justify-content: space-between;
        }

        th,
        td {
          padding: 8px 5px;
          font-size: clamp(11px, 3vw, 13px);
        }

        .lesson {
          font-size: clamp(15px, 4.4vw, 20px);
          font-weight: 900;
        }

        .subject-chip {
          font-size: clamp(12px, 3.4vw, 15px);
          padding: 4px 7px;
        }

        .subject-icon {
          font-size: 14px;
        }

        .table-wrap {
          max-height: min(74vh, 560px);
          scrollbar-gutter: stable;
        }
      }

      @media (max-width: 420px) {
        .class-week-nav__buttons {
          grid-template-columns: 1fr;
        }

        .bell-link__label {
          font-size: 14px;
        }

        .class-week-nav__title {
          line-height: 1.12;
        }
      }

      @media (max-width: 920px) {
        .table-wrap {
          overflow-x: auto;
          overflow-y: auto;
          -webkit-overflow-scrolling: touch;
          overscroll-behavior: contain;
          touch-action: pan-x pan-y pinch-zoom;
        }

        .day-card.is-single-class table {
          width: 100%;
          min-width: 0;
        }

        .day-card.is-single-class th:first-child,
        .day-card.is-single-class td:first-child,
        .day-card.is-single-class .lesson {
          width: 44px;
          min-width: 44px;
          max-width: 44px;
          padding-left: 4px;
          padding-right: 4px;
        }

        .day-card.is-single-class th[data-class]:not(.is-hidden),
        .day-card.is-single-class td[data-class]:not(.is-hidden) {
          width: calc(100% - 44px);
        }

        thead th:first-child {
          position: sticky;
          left: 0;
          z-index: 7;
          background: #e9f3fa;
          color: #203744;
          box-shadow: 2px 0 0 rgba(19, 35, 45, 0.18);
        }

        tbody td.lesson {
          position: sticky;
          left: 0;
          z-index: 6;
          background: #e9f3fa;
          box-shadow: 2px 0 0 rgba(19, 35, 45, 0.18);
        }
      }

      @media print {
        @page {
          size: A4 landscape;
          margin: 3mm;
        }

        body {
          background: #fff;
          margin: 0;
        }

        .site-bg {
          display: none !important;
        }

        .app {
          display: none !important;
        }

        #printStage {
          display: block !important;
          width: 100%;
          position: relative;
        }

        #printStage .print-bg-image {
          display: block !important;
          position: fixed !important;
          inset: 0 !important;
          width: 100vw !important;
          height: 100vh !important;
          object-fit: cover !important;
          opacity: 1 !important;
          z-index: 0 !important;
        }

        #printStage .print-sheet {
          width: 100%;
          display: flex;
          justify-content: center;
          align-items: flex-start;
          position: relative;
          z-index: 2;
        }

        #printStage .print-content {
          width: 99.5%;
          position: relative;
          z-index: 2;
        }

        #printStage .day-card {
          display: block;
          width: 100%;
          margin: 0;
          box-shadow: none;
          border: 0;
          overflow: visible;
          break-inside: avoid-page;
          page-break-inside: avoid;
        }

        #printStage .day-header {
          display: block;
          text-align: center;
          border: 0;
          padding: 0 0 6px;
          background: none;
          margin: 0;
        }

        #printStage .day-title {
          font-size: 30px;
          line-height: 1.08;
          margin: 0;
        }

        #printStage .day-subject-wrap,
        #printStage .btn-top,
        #printStage .btn-print {
          display: none !important;
        }

        #printStage .table-wrap {
          overflow: visible !important;
          max-height: none !important;
        }

        #printStage table {
          min-width: 0 !important;
          width: 100% !important;
          table-layout: fixed;
          border-collapse: collapse;
          break-inside: avoid-page;
          page-break-inside: avoid;
        }

        #printStage th:first-child,
        #printStage td:first-child {
          width: 4.8%;
          min-width: 0;
          max-width: 4.8%;
          padding-left: 3px;
          padding-right: 3px;
        }

        #printStage th[data-class],
        #printStage td[data-class] {
          width: auto;
        }

        #printStage th.is-hidden,
        #printStage td.is-hidden {
          display: table-cell !important;
        }

        #printStage th,
        #printStage td {
          padding: 9px 6px;
          font-size: 14.4px;
          line-height: 1.22;
          border-bottom: 1px solid #243948;
          border-right: 1px solid #243948;
          color: #102028;
        }

        #printStage tbody tr > th,
        #printStage tbody tr > td {
          border-bottom: 2px solid #1f3442;
        }

        #printStage thead th {
          font-size: 17px;
          font-weight: 800;
        }

        #printStage .lesson {
          min-width: 0;
          font-size: 20px;
          font-weight: 900;
        }

        #printStage .subject-stack {
          gap: 4px;
          flex-wrap: wrap;
        }

        #printStage .subject-chip {
          border: 0;
          background: transparent;
          color: #102028;
          font-size: 17px;
          line-height: 1.28;
          border-radius: 0;
          padding: 0;
          white-space: normal;
          display: inline-block;
          max-width: 100%;
          overflow-wrap: anywhere;
          word-break: break-word;
          box-shadow: none;
        }

        #printStage .subject-icon {
          font-size: 15px;
        }

        #printStage .divider {
          color: #556b78;
        }

        #printStage .empty {
          color: #556b78;
        }

        .kyiv-clock,
        .hero__topline {
          display: none !important;
        }
      }
    </style>
  </head>
  <body>
    <div class="site-bg" aria-hidden="true"></div>
    <div class="app" id="top">
      <header class="hero">
        <p class="hero__school">Турбівська філія Корнинського ліцею</p>
        <div class="hero__row">
          <div class="hero__top-tools">
            <aside class="kyiv-clock" data-kyiv-clock aria-live="polite">
              <p class="kyiv-clock__title">Київський час</p>
              <p class="kyiv-clock__date" data-kyiv-date>—</p>
              <p class="kyiv-clock__time" data-kyiv-time>--:--</p>
              <p class="kyiv-clock__sync" data-kyiv-sync>Синхронізація…</p>
            </aside>
          </div>
          <h1>
            <span class="hero__title-text">Розклад для 5 - 9 класів на ІІ семестр</span>
          </h1>
          <span class="hero__title-icon hero__title-icon--school" aria-hidden="true">🏫</span>
        </div>
      </header>

      <section class="controls" aria-label="Фільтри розкладу">
        <h2>Пошук по розкладу</h2>
        <div class="controls__grid">
          <label>
            Вибір класу
            <select id="classSearch"></select>
          </label>
          <label>
            Вибір предмету
            <select id="subjectSearch">
              <option value="">Усі предмети</option>
            </select>
          </label>
        </div>
      </section>

      <section class="class-week-nav" aria-label="Окремий розклад класу на тиждень">
        <div class="class-week-nav__head">
          <p class="class-week-nav__title">Окремий розклад кожного класу на тиждень</p>
          <div class="bell-link-wrap">
            <span class="bell-link__icon" aria-hidden="true">🔔</span>
            <a class="bell-link" href="Розклад дзвінків.html" aria-label="Відкрити сторінку розклад дзвінків">
              <span class="bell-link__label">Розклад дзвінків</span>
            </a>
          </div>
        </div>
        <div class="class-week-nav__buttons" id="classWeekButtons"></div>
      </section>

      <nav class="day-nav" id="dayNav" aria-label="Навігація по днях тижня"></nav>
      <main class="schedule" id="schedule"></main>

      <footer class="footer">
        <p>Натисніть на предмет у таблиці, щоб підсвітити його в усіх класах обраного дня.</p>
      </footer>
    </div>
    <div id="printStage" aria-hidden="true"></div>

    <script src="./schedule-config.js"></script>
    <script src="./schedule-core.js"></script>
    <script src="./kyiv-clock.js"></script>
    <script>
      const config = window.SchoolScheduleConfig;
      const core = window.ScheduleCore;
      if (!config || !core) {
        throw new Error("School schedule config is missing.");
      }

      const classColumns = Array.from(config.classes || []);
      const dayOrder = Array.from(config.dayOrder || []);
      const scheduleRows = Array.from(config.scheduleRows || []);
      const aliasMap = config.subjectAliasMap || {};
      const subjectIcons = config.subjectIcons || {};
      const tableMinWidth = Math.max(860, 72 + classColumns.length * 178);
      const classTints = classColumns.map((_, index) => core.getClassTintByIndex(index));
      const classPageHref = (className) => core.classPageHref(config, className);

      const escapeHtml = core.escapeHtml;

      const splitCellSubjects = (rawCell) => {
        return core.splitCellSubjects(rawCell, aliasMap, subjectIcons);
      };

      const groupedByDay = core.groupRowsByDay(dayOrder, scheduleRows);
      const subjectList = core.getSubjectList(scheduleRows, splitCellSubjects);

      const subjectOptionsMarkup = [
        '<option value="">Усі предмети</option>',
        ...subjectList.map(
          (subject) =>
            `<option value="${escapeHtml(subject)}">${subjectIcons[subject] || "📘"} ${escapeHtml(subject)}</option>`
        )
      ].join("");

      const schoolName = config.school?.name || "Школа";
      const mainTitle = config.school?.mainTitle || "Розклад занять";
      const heroSchool = document.querySelector(".hero__school");
      const heroTitleText = document.querySelector(".hero__title-text");
      const classWeekTitle = document.querySelector(".class-week-nav__title");
      const bellsLink = document.querySelector(".bell-link");
      if (heroSchool) {
        heroSchool.textContent = schoolName;
      }
      if (heroTitleText) {
        heroTitleText.textContent = mainTitle;
      }
      if (classWeekTitle && typeof config.classWeekTitle === "string" && config.classWeekTitle.trim()) {
        classWeekTitle.textContent = config.classWeekTitle.trim();
      }
      if (bellsLink) {
        bellsLink.href = config.bellsPagePath || "Розклад дзвінків.html";
      }
      document.title = `${schoolName} | ${mainTitle}`;

      const classSearch = document.getElementById("classSearch");
      classSearch.innerHTML = [
        '<option value="">Усі класи</option>',
        ...classColumns.map((className) => `<option value="${escapeHtml(className)}">${escapeHtml(className)}</option>`)
      ].join("");

      const classWeekButtons = document.getElementById("classWeekButtons");
      if (classWeekButtons) {
        classWeekButtons.innerHTML = classColumns
          .map((className, index) => {
            const delay = (0.14 + index * 0.04).toFixed(2);
            return `<a href="${classPageHref(className)}" style="--reveal-delay:${delay}s">${escapeHtml(className)}</a>`;
          })
          .join("");
      }

      const dayNav = document.getElementById("dayNav");
      dayNav.innerHTML = dayOrder
        .map((day) => `<a href="#${day.id}">${day.label}</a>`)
        .join("");

      const renderCell = (cellValue, className, classIndex) => {
        const tintStyle = ` style="--class-tint:${classTints[classIndex]};"`;
        const subjects = splitCellSubjects(cellValue);
        if (!subjects.length) {
          return `<td data-class="${escapeHtml(className)}"${tintStyle}><span class="empty">—</span></td>`;
        }

        const chips = subjects
          .map((subject) => {
            const wrapClass =
              subject.canonical === "Підприємництво і фінансова грамотність" || subject.label.length > 24
                ? " subject-chip--wrap"
                : "";
            return (
              `<button type="button" class="subject-chip${wrapClass}" data-subject="${escapeHtml(subject.canonical)}">` +
              `<span class="subject-icon">${escapeHtml(subject.icon)}</span>` +
              `<span>${escapeHtml(subject.label)}</span>` +
              `</button>`
            );
          })
          .join('<span class="divider">/</span>');

        return `<td data-class="${escapeHtml(className)}"${tintStyle}><div class="subject-stack">${chips}</div></td>`;
      };

      const renderDayCard = (dayMeta) => {
        const rows = groupedByDay.get(dayMeta.label) || [];
        const bodyRows = rows
          .map(
            (row) =>
              `<tr>` +
              `<td class="lesson">${row.lesson}</td>` +
              classColumns.map((className, index) => renderCell((row.classes || [])[index] || "", className, index)).join("") +
              `</tr>`
          )
          .join("");

        const headCols = classColumns
          .map((className) => {
            const titleMarkup = `<a class="class-link" href="${classPageHref(className)}">${escapeHtml(className)}</a>`;
            return `<th data-class="${escapeHtml(className)}">${titleMarkup}</th>`;
          })
          .join("");

        return `
          <section class="day-card" id="${dayMeta.id}" data-day="${dayMeta.label}">
            <div class="day-header">
              <label class="day-subject-wrap">
                Вибір предмету (день)
                <select class="day-subject">${subjectOptionsMarkup}</select>
              </label>
              <h3 class="day-title">${dayMeta.label}</h3>
              <div class="day-actions">
                <a class="btn btn-top" href="#top">Повернутись на початок</a>
                <button class="btn btn-print print-button" type="button">Друк</button>
              </div>
            </div>
            <div class="table-wrap">
              <table style="min-width:${tableMinWidth}px;">
                <thead>
                  <tr>
                    <th>Урок</th>
                    ${headCols}
                  </tr>
                </thead>
                <tbody>
                  ${bodyRows}
                </tbody>
              </table>
            </div>
          </section>
        `;
      };

      const scheduleRoot = document.getElementById("schedule");
      scheduleRoot.innerHTML = dayOrder.map((day) => renderDayCard(day)).join("");

      const subjectSearch = document.getElementById("subjectSearch");
      const printStage = document.getElementById("printStage");
      subjectSearch.innerHTML = subjectOptionsMarkup;

      const clearDayHighlight = (dayCard) => {
        dayCard.dataset.activeSubject = "";
        dayCard.querySelectorAll(".subject-chip").forEach((chip) => chip.classList.remove("is-linked"));
        dayCard.querySelectorAll("td.linked-cell").forEach((cell) => cell.classList.remove("linked-cell"));
      };

      const applyDayHighlight = (dayCard, subjectName) => {
        if (!subjectName) {
          clearDayHighlight(dayCard);
          return;
        }

        const isSame = dayCard.dataset.activeSubject === subjectName;
        if (isSame) {
          clearDayHighlight(dayCard);
          return;
        }

        dayCard.dataset.activeSubject = subjectName;
        dayCard.querySelectorAll("td[data-class]").forEach((cell) => {
          const chips = Array.from(cell.querySelectorAll(".subject-chip"));
          const linkedCell = chips.some((chip) => chip.dataset.subject === subjectName);
          cell.classList.toggle("linked-cell", linkedCell);
          chips.forEach((chip) => {
            chip.classList.toggle("is-linked", chip.dataset.subject === subjectName);
          });
        });
      };

      const applyFilters = () => {
        const selectedClass = classSearch.value;
        const selectedSubject = subjectSearch.value;

        document.querySelectorAll(".day-card").forEach((dayCard) => {
          const daySubject = dayCard.querySelector(".day-subject")?.value || "";
          const table = dayCard.querySelector("table");
          if (!table) {
            return;
          }

          dayCard.classList.toggle("is-single-class", Boolean(selectedClass));

          table.querySelectorAll("th[data-class]").forEach((headerCell) => {
            const hidden = Boolean(selectedClass) && headerCell.dataset.class !== selectedClass;
            headerCell.classList.toggle("is-hidden", hidden);
          });

          table.querySelectorAll("tbody tr").forEach((row) => {
            row.querySelectorAll("td[data-class]").forEach((cell) => {
              const hidden = Boolean(selectedClass) && cell.dataset.class !== selectedClass;
              cell.classList.toggle("is-hidden", hidden);
              const subjectChips = Array.from(cell.querySelectorAll(".subject-chip"));

              if (hidden) {
                cell.classList.remove("filter-dim", "filter-match");
                subjectChips.forEach((chip) => chip.classList.remove("is-filter-linked"));
                return;
              }

              const hasFilters = Boolean(selectedSubject || daySubject);

              if (!hasFilters) {
                cell.classList.remove("filter-dim", "filter-match");
                subjectChips.forEach((chip) => chip.classList.remove("is-filter-linked"));
                return;
              }

              if (!subjectChips.length) {
                cell.classList.add("filter-dim");
                cell.classList.remove("filter-match");
                return;
              }

              const matchesGlobal =
                !selectedSubject || subjectChips.some((chip) => chip.dataset.subject === selectedSubject);
              const matchesDay = !daySubject || subjectChips.some((chip) => chip.dataset.subject === daySubject);
              const matched = matchesGlobal && matchesDay;
              const activeFilterSubject =
                selectedSubject && daySubject
                  ? selectedSubject === daySubject
                    ? selectedSubject
                    : ""
                  : selectedSubject || daySubject;

              subjectChips.forEach((chip) => {
                const matchesChip = Boolean(activeFilterSubject) && chip.dataset.subject === activeFilterSubject;
                chip.classList.toggle("is-filter-linked", matched && matchesChip);
              });

              cell.classList.toggle("filter-match", matched);
              cell.classList.toggle("filter-dim", !matched);
            });
          });
        });
      };

      const buildPrintCard = (dayCard) => {
        const printCard = dayCard.cloneNode(true);
        printCard.querySelectorAll(".day-subject-wrap, .btn-top, .btn-print").forEach((node) => node.remove());
        printCard
          .querySelectorAll(".is-hidden, .filter-dim, .filter-match, .linked-cell")
          .forEach((node) => {
            node.classList.remove("is-hidden", "filter-dim", "filter-match", "linked-cell");
          });
        printCard.querySelectorAll(".subject-chip").forEach((chip) => {
          chip.classList.remove("is-linked", "is-filter-linked");
        });
        return printCard;
      };

      const preparePrintStage = (dayCard) => {
        printStage.innerHTML = "";

        const printBgImage = document.createElement("img");
        printBgImage.className = "print-bg-image";
        printBgImage.src = "./Заставка.png";
        printBgImage.alt = "";
        printBgImage.setAttribute("aria-hidden", "true");
        printStage.append(printBgImage);

        const printSheet = document.createElement("div");
        printSheet.className = "print-sheet";

        const printContent = document.createElement("div");
        printContent.className = "print-content";

        const printCard = buildPrintCard(dayCard);
        printContent.append(printCard);
        printSheet.append(printContent);
        printStage.append(printSheet);
      };

      const clearPrintState = () => {
        printStage.innerHTML = "";
      };

      classSearch.addEventListener("change", applyFilters);
      subjectSearch.addEventListener("change", applyFilters);

      document.querySelectorAll(".day-card").forEach((dayCard) => {
        const daySelect = dayCard.querySelector(".day-subject");
        daySelect?.addEventListener("change", applyFilters);

        dayCard.addEventListener("click", (event) => {
          const subjectChip = event.target.closest(".subject-chip");
          if (!subjectChip || !dayCard.contains(subjectChip)) {
            return;
          }
          applyDayHighlight(dayCard, subjectChip.dataset.subject);
        });

        const printButton = dayCard.querySelector(".print-button");
        printButton?.addEventListener("click", () => {
          preparePrintStage(dayCard);
          const printBgImage = printStage.querySelector(".print-bg-image");
          if (printBgImage && !printBgImage.complete) {
            const tryPrint = () => window.print();
            printBgImage.addEventListener("load", tryPrint, { once: true });
            printBgImage.addEventListener("error", tryPrint, { once: true });
            return;
          }
          window.print();
        });
      });

      const getTableScrollContainers = () =>
        Array.from(
          new Set(
            Array.from(document.querySelectorAll("table"), (table) => {
              const explicitContainer = table.closest("[data-table-scroll]");
              if (explicitContainer) {
                return explicitContainer;
              }
              return table.parentElement;
            }).filter(Boolean)
          )
        );

      const enableTableWheelScroll = () => {
        getTableScrollContainers().forEach((container) => {
          container.addEventListener(
            "wheel",
            (event) => {
              const canScrollX = container.scrollWidth > container.clientWidth + 1;
              if (!canScrollX) {
                return;
              }

              const horizontalGesture = event.shiftKey || Math.abs(event.deltaX) > Math.abs(event.deltaY);
              if (!horizontalGesture) {
                return;
              }

              const delta = event.deltaX || event.deltaY;
              if (!delta) {
                return;
              }

              const previousLeft = container.scrollLeft;
              container.scrollLeft += delta;

              if (container.scrollLeft !== previousLeft) {
                event.preventDefault();
              }
            },
            { passive: false }
          );
        });
      };

      enableTableWheelScroll();

      window.addEventListener("afterprint", clearPrintState);
      if (typeof window.initKyivClock === "function") {
        window.initKyivClock();
      }
      applyFilters();
    </script>
  </body>
</html>
